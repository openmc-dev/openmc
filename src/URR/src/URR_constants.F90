module URR_constants

  implicit none
!TODO  private
  public

  integer, parameter :: FALSE = 0
  real(8), parameter :: ZERO  = 0.0_8
  real(8), parameter :: HALF  = 0.5_8
  real(8), parameter :: ONE   = 1.0_8
  real(8), parameter :: TWO   = 2.0_8
  real(8), parameter :: THREE = 3.0_8
  real(8), parameter :: PI    = 3.1415926535897932_8
  real(8), parameter :: SQRT_PI = sqrt(PI)
  real(8), parameter :: FOUR  = 4.0_8
  real(8), parameter :: INF   = huge(1.0_8) ! largest positive non-infinite dble
  complex(8), parameter :: ONEI = (ZERO, ONE)

  real(8), parameter :: M_NEUTRON_eV = 939.565379e6_8  ! neutron mass [eV]
  real(8), parameter :: HBAR_C       = 197.3269718e6_8 ! [eV-fm]
  real(8), parameter :: K_BOLTZMANN  = 8.6173324e-11_8 ! Boltzmann constant in MeV/K
  real(8), parameter :: C_1 = sqrt(TWO * M_NEUTRON_eV) / HBAR_C * 1.0e1_8 ! constant appearing in SLBW equations

  ! Lower cross section cutoff threshold value [b]
  real(8), parameter :: XS_CUTOFF = 1.0e-14_8

  ! Relative precision to use for comparing ENDF-6 file values
  real(8), parameter :: ENDF_PRECISION = 1.0e-7_8

  ! Faddeeva (W) function evaluation methods
  integer, parameter :: MIT_W   = 1
  integer, parameter :: QUICK_W = 2

  ! Resonance formalisms
  integer, parameter :: SLBW         = 1
  integer, parameter :: MLBW         = 2
  integer, parameter :: REICH_MOORE  = 3
  integer, parameter :: ADLER_ADLER  = 4
  integer, parameter :: R_MATRIX     = 5
  integer, parameter :: R_FUNCTION   = 6
  integer, parameter :: R_MATRIX_LIM = 7
  integer, parameter :: MNBW         = 8

  ! Cross section representation formats
  integer, parameter :: PROB_BANDS = 1
  integer, parameter :: POINTWISE  = 2
  integer, parameter :: ON_THE_FLY = 3

  ! Resonance parameters' energy-dependence representation
  integer, parameter :: E_NEUTRON   = 1 ! E_n-dependent
  integer, parameter :: E_RESONANCE = 2 ! E_lambda-dependent

  ! URR realization frequencies
  integer, parameter :: EVENT      = 1
  integer, parameter :: HISTORY    = 2
  integer, parameter :: BATCH      = 3
  integer, parameter :: SIMULATION = 4

  ! Probability table cross section band spacing and energy schemes
  integer, parameter :: LINEAR      = 1
  integer, parameter :: LOGARITHMIC = 2
  integer, parameter :: USER        = 3
  integer, parameter :: ENDF6       = 4

  ! Interpolation schemes
  integer, parameter :: HISTOGRAM     = 1  ! y is constant in x
  integer, parameter :: LINEAR_LINEAR = 2  ! y is linear in x
  integer, parameter :: LINEAR_LOG    = 3  ! y is linear in ln(x)
  integer, parameter :: LOG_LINEAR    = 4  ! ln(y) is linear in x
  integer, parameter :: LOG_LOG       = 5  ! ln(y) is linear in ln(x)
  integer, parameter :: SQRT_LINEAR   = 7  ! y is linear in sqrt(x)
  integer, parameter :: SQRT_LOG      = 8  ! ln(y) is linear in sqrt(x)
  integer, parameter :: STATISTICAL   = 9  ! linear statistical interpolation
  integer, parameter :: LOW_NEIGHBOR  = 10 ! use lower bounding value

  ! Source of background cross sections
  integer, parameter :: ENDFFILE  = 1

  ! Secondary angular distribution representation
  integer, parameter :: ISOTROPIC            = 1
  integer, parameter :: EQUIPROBABLE_32_BINS = 2
  integer, parameter :: TABULAR              = 3

  ! tabulated chi-squared distribution for 1-4 degrees of freedom with expected
  ! bin values taken while preserving equiprobable bins
  real(8), dimension(100,4), parameter :: chi2 = reshape((/&
       5.2361522573878303e-05_8,&
       3.6657014603380927e-04_8,&
       9.9518491948712953e-04_8,&
       1.9386012997931335e-03_8,&
       3.1974134834564794e-03_8,&
       4.7724156249104943e-03_8,&
       6.6646034689871562e-03_8,&
       8.8751764045787822e-03_8,&
       1.1405539948348784e-02_8,&
       1.4257308669262333e-02_8,&
       1.7432309566699937e-02_8,&
       2.0932585917008924e-02_8,&
       2.4760401605548443e-02_8,&
       2.8918245963614714e-02_8,&
       3.3408839132121698e-02_8,&
       3.8235137976558628e-02_8,&
       4.3400342580600923e-02_8,&
       4.8907903348823251e-02_8,&
       5.4761528752270645e-02_8,&
       6.0965193754262480e-02_8,&
       6.7523148957703075e-02_8,&
       7.4439930519469649e-02_8,&
       8.1720370882077772e-02_8,&
       8.9369610378026390e-02_8,&
       9.7393109767770936e-02_8,&
       1.0579666377851940e-01_8,&
       1.1458641571792876e-01_8,&
       1.2376887324425483e-01_8,&
       1.3335092538298998e-01_8,&
       1.4333986088928199e-01_8,&
       1.5374338806581933e-01_8,&
       1.6456965615734245e-01_8,&
       1.7582727845596630e-01_8,&
       1.8752535726568245e-01_8,&
       1.9967351089080942e-01_8,&
       2.1228190283110535e-01_8,&
       2.2536127338660603e-01_8,&
       2.3892297389851302e-01_8,&
       2.5297900387789557e-01_8,&
       2.6754205130376008e-01_8,&
       2.8262553640506494e-01_8,&
       2.9824365927889102e-01_8,&
       3.1441145174029650e-01_8,&
       3.3114483384809063e-01_8,&
       3.4846067560687466e-01_8,&
       3.6637686441014672e-01_8,&
       3.8491237886273233e-01_8,&
       4.0408736970584419e-01_8,&
       4.2392324866638764e-01_8,&
       4.4444278616514943e-01_8,&
       4.6567021895116673e-01_8,&
       4.8763136888124214e-01_8,&
       5.1035377424519790e-01_8,&
       5.3386683524416667e-01_8,&
       5.5820197547795081e-01_8,&
       5.8339282158625361e-01_8,&
       6.0947540353240148e-01_8,&
       6.3648837842569905e-01_8,&
       6.6447328126331806e-01_8,&
       6.9347480655435001e-01_8,&
       7.2354112548443750e-01_8,&
       7.5472424412145056e-01_8,&
       7.8708040918100841e-01_8,&
       8.2067056911047287e-01_8,&
       8.5556089976799887e-01_8,&
       8.9182340583782349e-01_8,&
       9.2953661143024902e-01_8,&
       9.6878635618287412e-01_8,&
       1.0096667167701208e+00_8,&
       1.0522810782469578e+00_8,&
       1.0967433853865443e+00_8,&
       1.1431796114924373e+00_8,&
       1.1917294915911445e+00_8,&
       1.2425485791436743e+00_8,&
       1.2958107014323266e+00_8,&
       1.3517109099512452e+00_8,&
       1.4104690504006043e+00_8,&
       1.4723341150469957e+00_8,&
       1.5375895923398502e+00_8,&
       1.6065601007852524e+00_8,&
       1.6796196952261095e+00_8,&
       1.7572023777114727e+00_8,&
       1.8398155536525733e+00_8,&
       1.9280574813581017e+00_8,&
       2.0226402253972973e+00_8,&
       2.1244203353453672e+00_8,&
       2.2344405927812980e+00_8,&
       2.3539879879111569e+00_8,&
       2.4846761319111303e+00_8,&
       2.6285655985359493e+00_8,&
       2.7883452676527738e+00_8,&
       2.9676159813222007e+00_8,&
       3.1713546653829661e+00_8,&
       3.4067170514840428e+00_8,&
       3.6845270836767279e+00_8,&
       4.0223076143802530e+00_8,&
       4.4512871914763084e+00_8,&
       5.0360207017734400e+00_8,&
       5.9512649086256326e+00_8,&
       8.4491659621504542e+00_8,&
       1.0033501006713585e-02_8,&
       3.0235864759474755e-02_8,&
       5.0644382200351203e-02_8,&
       7.1263304144476777e-02_8,&
       9.2097014254383214e-02_8,&
       1.1315003463415688e-01_8,&
       1.3442703172104936e-01_8,&
       1.5593282249399767e-01_8,&
       1.7767238101947350e-01_8,&
       1.9965084535718647e-01_8,&
       2.2187352484936035e-01_8,&
       2.4434590781962723e-01_8,&
       2.6707366970940932e-01_8,&
       2.9006268168195443e-01_8,&
       3.1331901972664644e-01_8,&
       3.3684897429907912e-01_8,&
       3.6065906053472679e-01_8,&
       3.8475602907845413e-01_8,&
       4.0914687757374879e-01_8,&
       4.3383886286217227e-01_8,&
       4.5883951394450606e-01_8,&
       4.8415664576310247e-01_8,&
       5.0979837386716853e-01_8,&
       5.3577313003122440e-01_8,&
       5.6208967890041917e-01_8,&
       5.8875713574674671e-01_8,&
       6.1578498542415216e-01_8,&
       6.4318310262303713e-01_8,&
       6.7096177353100350e-01_8,&
       6.9913171901966831e-01_8,&
       7.2770411948771163e-01_8,&
       7.5669064150490140e-01_8,&
       7.8610346641513551e-01_8,&
       8.1595532107502389e-01_8,&
       8.4625951092071139e-01_8,&
       8.7702995558135655e-01_8,&
       9.0828122727129657e-01_8,&
       9.4002859223442736e-01_8,&
       9.7228805552877706e-01_8,&
       1.0050764094843230e+00_8,&
       1.0384112861988468e+00_8,&
       1.0723112144860729e+00_8,&
       1.1067956817302635e+00_8,&
       1.1418852011741760e+00_8,&
       1.1776013852112666e+00_8,&
       1.2139670253460237e+00_8,&
       1.2510061795594358e+00_8,&
       1.2887442679197412e+00_8,&
       1.3272081773889526e+00_8,&
       1.3664263769095955e+00_8,&
       1.4064290440029588e+00_8,&
       1.4472482042923114e+00_8,&
       1.4889178855641574e+00_8,&
       1.5314742882274328e+00_8,&
       1.5749559743082053e+00_8,&
       1.6194040774542930e+00_8,&
       1.6648625368154983e+00_8,&
       1.7113783581329287e+00_8,&
       1.7590019059264674e+00_8,&
       1.8077872313378793e+00_8,&
       1.8577924409736915e+00_8,&
       1.9090801130691049e+00_8,&
       1.9617177684434415e+00_8,&
       2.0157784051434957e+00_8,&
       2.0713411073952446e+00_8,&
       2.1284917416161937e+00_8,&
       2.1873237548648219e+00_8,&
       2.2479390943710857e+00_8,&
       2.3104492708727187e+00_8,&
       2.3749765936265970e+00_8,&
       2.4416556114623531e+00_8,&
       2.5106348025719853e+00_8,&
       2.5820785663985397e+00_8,&
       2.6561695848594633e+00_8,&
       2.7331116382691767e+00_8,&
       2.8131329852675315e+00_8,&
       2.8964904480156624e+00_8,&
       2.9834743870013902e+00_8,&
       3.0744148085940641e+00_8,&
       3.1696889297520667e+00_8,&
       3.2697306381410751e+00_8,&
       3.3750424479133900e+00_8,&
       3.4862107856258033e+00_8,&
       3.6039257857375073e+00_8,&
       3.7290072933696399e+00_8,&
       3.8624395681371251e+00_8,&
       4.0054184367488785e+00_8,&
       4.1594166728882609e+00_8,&
       4.3262767786284364e+00_8,&
       4.5083462302929407e+00_8,&
       4.7086809041471618e+00_8,&
       4.9313626468018068e+00_8,&
       5.1820177918730055e+00_8,&
       5.4687119159383473e+00_8,&
       5.8036058655805505e+00_8,&
       6.2063161365943529e+00_8,&
       6.7116592150256986e+00_8,&
       7.3912553622073647e+00_8,&
       8.4377516497364073e+00_8,&
       1.1210340370973686e+01_8,&
       6.8445840470308383e-02_8,&
       1.5100034771915843e-01_8,&
       2.1551987807422432e-01_8,&
       2.7296268032709492e-01_8,&
       3.2622940327935962e-01_8,&
       3.7667790160175518e-01_8,&
       4.2508370358766145e-01_8,&
       4.7194279239893744e-01_8,&
       5.1759698373925178e-01_8,&
       5.6229485133305723e-01_8,&
       6.0622470846289511e-01_8,&
       6.4953392303497304e-01_8,&
       6.9234093087234361e-01_8,&
       7.3474307291383112e-01_8,&
       7.7682191088101582e-01_8,&
       8.1864695147378741e-01_8,&
       8.6027832833757922e-01_8,&
       9.0176877983612724e-01_8,&
       9.4316513811993008e-01_8,&
       9.8450947108920839e-01_8,&
       1.0258399727912586e+00_8,&
       1.0671916682347822e+00_8,&
       1.1085969791461903e+00_8,&
       1.1500861840892049e+00_8,&
       1.1916877973642679e+00_8,&
       1.2334288848024455e+00_8,&
       1.2753353300859189e+00_8,&
       1.3174320619909312e+00_8,&
       1.3597432505811178e+00_8,&
       1.4022924786272399e+00_8,&
       1.4451028932156729e+00_8,&
       1.4881973415202965e+00_8,&
       1.5315984939545633e+00_8,&
       1.5753289573465672e+00_8,&
       1.6194113803319028e+00_8,&
       1.6638685528185568e+00_8,&
       1.7087235011125861e+00_8,&
       1.7539995800922088e+00_8,&
       1.7997205636636548e+00_8,&
       1.8459107346190737e+00_8,&
       1.8925949749385853e+00_8,&
       1.9397988575227763e+00_8,&
       1.9875487403178107e+00_8,&
       2.0358718637868938e+00_8,&
       2.0847964526978844e+00_8,&
       2.1343518232300300e+00_8,&
       2.1845684964574215e+00_8,&
       2.2354783193401633e+00_8,&
       2.2871145944518232e+00_8,&
       2.3395122197887064e+00_8,&
       2.3927078401548001e+00_8,&
       2.4467400117919293e+00_8,&
       2.5016493821335106e+00_8,&
       2.5574788868147769e+00_8,&
       2.6142739663679690e+00_8,&
       2.6720828053882273e+00_8,&
       2.7309565973775838e+00_8,&
       2.7909498389794463e+00_8,&
       2.8521206579161578e+00_8,&
       2.9145311796652655e+00_8,&
       2.9782479387776153e+00_8,&
       3.0433423417829970e+00_8,&
       3.1098911899031334e+00_8,&
       3.1779772713287335e+00_8,&
       3.2476900347077642e+00_8,&
       3.3191263578080776e+00_8,&
       3.3923914281841236e+00_8,&
       3.4675997562325906e+00_8,&
       3.5448763454753069e+00_8,&
       3.6243580505004620e+00_8,&
       3.7061951600825447e+00_8,&
       3.7905532520487486e+00_8,&
       3.8776153780842386e+00_8,&
       3.9675846517429401e+00_8,&
       4.0606873326438402e+00_8,&
       4.1571765258515283e+00_8,&
       4.2573366501392140e+00_8,&
       4.3614888756036256e+00_8,&
       4.4699977948979086e+00_8,&
       4.5832796804675722e+00_8,&
       4.7018128035906628e+00_8,&
       4.8261504664869381e+00_8,&
       4.9569376523570625e+00_8,&
       5.0949325714431399e+00_8,&
       5.2410349415867721e+00_8,&
       5.3963237020682318e+00_8,&
       5.5621082135126638e+00_8,&
       5.7399991881525931e+00_8,&
       5.9320092563219085e+00_8,&
       6.1406994197980982e+00_8,&
       6.3693991105142747e+00_8,&
       6.6225493533220510e+00_8,&
       6.9062624129574450e+00_8,&
       7.2292862961073432e+00_8,&
       7.6047873656073781e+00_8,&
       8.0539619114173657e+00_8,&
       8.6143443538629256e+00_8,&
       9.3629335234829068e+00_8,&
       1.0506089294536801e+01_8,&
       1.3486550432895573e+01_8,&
       1.9559695720196493e-01_8,&
       3.6654661317972215e-01_8,&
       4.8369150691127061e-01_8,&
       5.8196287845694095e-01_8,&
       6.6951354752681236e-01_8,&
       7.4996729294063158e-01_8,&
       8.2531974682625786e-01_8,&
       8.9681085396225890e-01_8,&
       9.6527447379825393e-01_8,&
       1.0313039645081317e+00_8,&
       1.0953399453660284e+00_8,&
       1.1577207743428419e+00_8,&
       1.2187134520889087e+00_8,&
       1.2785335015626327e+00_8,&
       1.3373582809681861e+00_8,&
       1.3953362022539313e+00_8,&
       1.4525932975404519e+00_8,&
       1.5092380114338664e+00_8,&
       1.5653647732450024e+00_8,&
       1.6210567097541417e+00_8,&
       1.6763877397217370e+00_8,&
       1.7314242153557968e+00_8,&
       1.7862262263145512e+00_8,&
       1.8408486486482984e+00_8,&
       1.8953419984428517e+00_8,&
       1.9497531341834025e+00_8,&
       2.0041258407262728e+00_8,&
       2.0585013197703494e+00_8,&
       2.1129186059035727e+00_8,&
       2.1674149230066977e+00_8,&
       2.2220259925977954e+00_8,&
       2.2767863032911895e+00_8,&
       2.3317293487084729e+00_8,&
       2.3868878397761839e+00_8,&
       2.4422938962570533e+00_8,&
       2.4979792215205392e+00_8,&
       2.5539752639006177e+00_8,&
       2.6103133674763810e+00_8,&
       2.6670249147094554e+00_8,&
       2.7241414630623040e+00_8,&
       2.7816948774816499e+00_8,&
       2.8397174604512325e+00_8,&
       2.8982420811839344e+00_8,&
       2.9573023054391534e+00_8,&
       3.0169325273909999e+00_8,&
       3.0771681049573041e+00_8,&
       3.1380455000074954e+00_8,&
       3.1996024249084458e+00_8,&
       3.2618779969343259e+00_8,&
       3.3249129021703441e+00_8,&
       3.3887495706703041e+00_8,&
       3.4534323647957055e+00_8,&
       3.5190077828775581e+00_8,&
       3.5855246805903294e+00_8,&
       3.6530345127414847e+00_8,&
       3.7215915985445833e+00_8,&
       3.7912534138916278e+00_8,&
       3.8620809146701407e+00_8,&
       3.9341388958097676e+00_8,&
       4.0074963915081963e+00_8,&
       4.0822271230123546e+00_8,&
       4.1584100014434586e+00_8,&
       4.2361296945114582e+00_8,&
       4.3154772676087871e+00_8,&
       4.3965509117920645e+00_8,&
       4.4794567736368460e+00_8,&
       4.5643099050101883e+00_8,&
       4.6512353546132843e+00_8,&
       4.7403694278956019e+00_8,&
       4.8318611479259577e+00_8,&
       4.9258739573759858e+00_8,&
       5.0225877114340918e+00_8,&
       5.1222010238797715e+00_8,&
       5.2249340446443524e+00_8,&
       5.3310317682151434e+00_8,&
       5.4407680000031222e+00_8,&
       5.5544501448001302e+00_8,&
       5.6724250313187019e+00_8,&
       5.7950860547996710e+00_8,&
       5.9228820135617131e+00_8,&
       6.0563281468068970e+00_8,&
       6.1960200678016255e+00_8,&
       6.3426515564370485e+00_8,&
       6.4970375722046603e+00_8,&
       6.6601444445014435e+00_8,&
       6.8331301115602772e+00_8,&
       7.0173987177487653e+00_8,&
       7.2146762060187619e+00_8,&
       7.4271174283417203e+00_8,&
       7.6574620270035592e+00_8,&
       7.9092684969487443e+00_8,&
       8.1872789146451925e+00_8,&
       8.4980132789380303e+00_8,&
       8.8507929093144444e+00_8,&
       9.2596300868203301e+00_8,&
       9.7470523027115679e+00_8,&
       1.0352888667619078e+01_8,&
       1.1158690088753749e+01_8,&
       1.2382461545773161e+01_8,&
       1.5538540717378252e+01_8/),(/100,4/))

contains


!< Returns the name of the resonance formalism being used
  function get_formalism_name(i) result(formalism_str)

    integer :: i ! formalism integer parameter
    character(:), allocatable :: formalism_str

    select case(i)
    case(1)
      formalism_str = 'SLBW'
    case(2)
      formalism_str = 'MLBW (elastic channel only)'
    case(3)
      formalism_str = 'Reich-Moore'
    case(4)
      formalism_str = 'Adler-Adler'
    case(5)
      formalism_str = 'R-Matrix'
    case(6)
      formalism_str = 'R-Function'
    case(7)
      formalism_str = 'R-Matrix Limited'
    case(8)
      formalism_str = 'MNBW'
    case default
      continue
    end select

    return

  end function get_formalism_name


!< Returns whether the energy of the neutron or resonance determines
!! energy dependence of parameters
  function get_energy_dependence(i) result(dependence_str)

    integer :: i ! energy dependence integer parameter
    character(:), allocatable :: dependence_str

    select case(i)
    case(1)
      dependence_str = 'Neutron'
    case(2)
      dependence_str = 'Resonance'
    case default
      continue
    end select

    return

  end function get_energy_dependence


!< Returns the Faddeeva function evaluation method
  function get_faddeeva_method(i) result(faddeeva_str)

    integer :: i ! faddeeva method integer parameter
    character(:), allocatable :: faddeeva_str

    select case(i)
    case(1)
      faddeeva_str = 'MIT'
    case(2)
      faddeeva_str = 'QUICKW'
    case default
      continue
    end select

    return

  end function get_faddeeva_method


end module URR_constants
