module avg_urr_xs_values

  use global
  use unresolved, only: Isotope, isotopes, represent_params

  implicit none

contains

  subroutine set_avg_urr_xs(i)

    type(Isotope), pointer :: tope => null() ! isotope object pointer
    integer :: i ! isotope index
    !$omp threadprivate(tope)

    tope => isotopes(i)

    if (represent_params == CONTINUOUS) then
      select case(tope % MAT)
      case default
        if (tope % LSSF == 1) then
          if (master) then
            write(*,'(A80)') 'Computing averaged URR cross sections&
              & for an LSSF = 1 isotope'
          end if
        end if
      end select

    else if (represent_params == DISCRETE) then
      select case(tope % MAT)
      case(9228)
        ! 0.1% rel tol
        tope % Eavg =&
          (/&
          2.250000E+03_8, &
          2.363331E+03_8, &
          2.482370E+03_8, &
          2.607405E+03_8, &
          2.738738E+03_8, &
          2.876686E+03_8, &
          3.021582E+03_8, &
          3.173777E+03_8, &
          3.333638E+03_8, &
          3.501551E+03_8, &
          3.677921E+03_8, &
          3.863175E+03_8, &
          4.057760E+03_8, &
          4.262147E+03_8, &
          4.476828E+03_8, &
          4.702322E+03_8, &
          4.939174E+03_8, &
          5.187957E+03_8, &
          5.449270E+03_8, &
          5.723746E+03_8, &
          6.012046E+03_8, &
          6.314868E+03_8, &
          6.632943E+03_8, &
          6.967040E+03_8, &
          7.317964E+03_8, &
          7.686564E+03_8, &
          8.073730E+03_8, &
          8.480398E+03_8, &
          8.907549E+03_8, &
          9.356216E+03_8, &
          9.827481E+03_8, &
          1.032248E+04_8, &
          1.084242E+04_8, &
          1.138854E+04_8, &
          1.196218E+04_8, &
          1.256470E+04_8, &
          1.319758E+04_8, &
          1.386233E+04_8, &
          1.456056E+04_8, &
          1.529397E+04_8, &
          1.606431E+04_8, &
          1.687346E+04_8, &
          1.772336E+04_8, &
          1.861607E+04_8, &
          1.955375E+04_8, &
          2.053866E+04_8, &
          2.157317E+04_8, &
          2.265980E+04_8, &
          2.380115E+04_8, &
          2.500000E+04_8  &
          /)

        tope % avg_urr_n =&
          (/&
          1.208406E+01_8, &
          1.207576E+01_8, &
          1.206654E+01_8, &
          1.205935E+01_8, &
          1.204983E+01_8, &
          1.203834E+01_8, &
          1.202974E+01_8, &
          1.202116E+01_8, &
          1.201324E+01_8, &
          1.199967E+01_8, &
          1.199292E+01_8, &
          1.198077E+01_8, &
          1.197323E+01_8, &
          1.195910E+01_8, &
          1.194767E+01_8, &
          1.193507E+01_8, &
          1.192316E+01_8, &
          1.190988E+01_8, &
          1.189888E+01_8, &
          1.188894E+01_8, &
          1.187391E+01_8, &
          1.185992E+01_8, &
          1.184436E+01_8, &
          1.183229E+01_8, &
          1.181524E+01_8, &
          1.180042E+01_8, &
          1.178354E+01_8, &
          1.176844E+01_8, &
          1.175663E+01_8, &
          1.173645E+01_8, &
          1.172119E+01_8, &
          1.170408E+01_8, &
          1.168394E+01_8, &
          1.166371E+01_8, &
          1.164668E+01_8, &
          1.163009E+01_8, &
          1.161016E+01_8, &
          1.158859E+01_8, &
          1.156919E+01_8, &
          1.154641E+01_8, &
          1.152863E+01_8, &
          1.150674E+01_8, &
          1.148292E+01_8, &
          1.145811E+01_8, &
          1.143705E+01_8, &
          1.141325E+01_8, &
          1.139069E+01_8, &
          1.136181E+01_8, &
          1.133907E+01_8, &
          1.131403E+01_8  &
          /)

        tope % avg_urr_f =&
          (/&
          5.636044E+00_8, &
          5.500452E+00_8, &
          5.376641E+00_8, &
          5.253394E+00_8, &
          5.126250E+00_8, &
          5.014730E+00_8, &
          4.893350E+00_8, &
          4.775045E+00_8, &
          4.673975E+00_8, &
          4.563735E+00_8, &
          4.464827E+00_8, &
          4.364588E+00_8, &
          4.261051E+00_8, &
          4.171896E+00_8, &
          4.080644E+00_8, &
          3.990747E+00_8, &
          3.899208E+00_8, &
          3.818399E+00_8, &
          3.741687E+00_8, &
          3.661097E+00_8, &
          3.583416E+00_8, &
          3.504486E+00_8, &
          3.439325E+00_8, &
          3.367409E+00_8, &
          3.300817E+00_8, &
          3.233335E+00_8, &
          3.171118E+00_8, &
          3.111893E+00_8, &
          3.056200E+00_8, &
          2.999949E+00_8, &
          2.938186E+00_8, &
          2.886433E+00_8, &
          2.830789E+00_8, &
          2.779945E+00_8, &
          2.735189E+00_8, &
          2.684188E+00_8, &
          2.639686E+00_8, &
          2.594972E+00_8, &
          2.553326E+00_8, &
          2.512998E+00_8, &
          2.475778E+00_8, &
          2.437543E+00_8, &
          2.404725E+00_8, &
          2.365770E+00_8, &
          2.337865E+00_8, &
          2.300410E+00_8, &
          2.273097E+00_8, &
          2.240289E+00_8, &
          2.208522E+00_8, &
          2.185192E+00_8  &
          /)

        tope % avg_urr_g =&
          (/&
          2.034381E+00_8, &
          1.981413E+00_8, &
          1.936097E+00_8, &
          1.890495E+00_8, &
          1.844920E+00_8, &
          1.800961E+00_8, &
          1.756408E+00_8, &
          1.715172E+00_8, &
          1.678913E+00_8, &
          1.634375E+00_8, &
          1.598601E+00_8, &
          1.560564E+00_8, &
          1.524844E+00_8, &
          1.491905E+00_8, &
          1.457326E+00_8, &
          1.422624E+00_8, &
          1.390407E+00_8, &
          1.362409E+00_8, &
          1.332104E+00_8, &
          1.303769E+00_8, &
          1.274635E+00_8, &
          1.247036E+00_8, &
          1.220590E+00_8, &
          1.194799E+00_8, &
          1.170389E+00_8, &
          1.145868E+00_8, &
          1.122232E+00_8, &
          1.100222E+00_8, &
          1.080034E+00_8, &
          1.059596E+00_8, &
          1.038386E+00_8, &
          1.019940E+00_8, &
          9.993200E-01_8, &
          9.802410E-01_8, &
          9.644016E-01_8, &
          9.438621E-01_8, &
          9.295298E-01_8, &
          9.125237E-01_8, &
          8.982014E-01_8, &
          8.829200E-01_8, &
          8.695749E-01_8, &
          8.555446E-01_8, &
          8.416521E-01_8, &
          8.286227E-01_8, &
          8.171900E-01_8, &
          8.031967E-01_8, &
          7.924035E-01_8, &
          7.799826E-01_8, &
          7.686621E-01_8, &
          7.586260E-01_8  &
          /)

        tope % avg_urr_x =&
          (/&
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO, &
          ZERO  &
          /)
      case(9237)
        ! 0.1% rel tol
        tope % Eavg =&
          (/&
          2.000000E+04_8, &
          2.083679E+04_8, &
          2.170859E+04_8, &
          2.261687E+04_8, &
          2.356315E+04_8, &
          2.454902E+04_8, &
          2.557614E+04_8, &
          2.664623E+04_8, &
          2.776109E+04_8, &
          2.892260E+04_8, &
          3.013271E+04_8, &
          3.139345E+04_8, &
          3.270693E+04_8, &
          3.407538E+04_8, &
          3.550107E+04_8, &
          3.698642E+04_8, &
          3.853391E+04_8, &
          4.014615E+04_8, &
          4.182585E+04_8, &
          4.357582E+04_8, &
          4.539901E+04_8, &
          4.729848E+04_8, &
          4.927743E+04_8, &
          5.133917E+04_8, &
          5.348718E+04_8, &
          5.572506E+04_8, &
          5.805656E+04_8, &
          6.048562E+04_8, &
          6.301631E+04_8, &
          6.565288E+04_8, &
          6.839977E+04_8, &
          7.126158E+04_8, &
          7.424313E+04_8, &
          7.734942E+04_8, &
          8.058568E+04_8, &
          8.395735E+04_8, &
          8.747008E+04_8, &
          9.112979E+04_8, &
          9.494261E+04_8, &
          9.891496E+04_8, &
          1.030535E+05_8, &
          1.073652E+05_8, &
          1.118573E+05_8, &
          1.165374E+05_8, &
          1.214133E+05_8, &
          1.264931E+05_8, &
          1.317855E+05_8, &
          1.372994E+05_8, &
          1.430439E+05_8, &
          1.490288E+05_8  &
          /)

        tope % avg_urr_n =&
          (/&
          1.380758E+01_8, &
          1.376840E+01_8, &
          1.372759E+01_8, &
          1.368260E+01_8, &
          1.363946E+01_8, &
          1.358102E+01_8, &
          1.354323E+01_8, &
          1.349970E+01_8, &
          1.347983E+01_8, &
          1.342204E+01_8, &
          1.338560E+01_8, &
          1.334148E+01_8, &
          1.330998E+01_8, &
          1.325790E+01_8, &
          1.322706E+01_8, &
          1.318061E+01_8, &
          1.314480E+01_8, &
          1.311346E+01_8, &
          1.307147E+01_8, &
          1.302986E+01_8, &
          1.299810E+01_8, &
          1.296363E+01_8, &
          1.292614E+01_8, &
          1.284421E+01_8, &
          1.278661E+01_8, &
          1.272738E+01_8, &
          1.266738E+01_8, &
          1.261170E+01_8, &
          1.254963E+01_8, &
          1.248944E+01_8, &
          1.242361E+01_8, &
          1.236863E+01_8, &
          1.230647E+01_8, &
          1.224495E+01_8, &
          1.218441E+01_8, &
          1.212879E+01_8, &
          1.205643E+01_8, &
          1.200105E+01_8, &
          1.193765E+01_8, &
          1.187464E+01_8, &
          1.180979E+01_8, &
          1.175518E+01_8, &
          1.169754E+01_8, &
          1.162591E+01_8, &
          1.156468E+01_8, &
          1.150013E+01_8, &
          1.143999E+01_8, &
          1.137210E+01_8, &
          1.130552E+01_8, &
          1.124648E+01_8  &
          /)

        tope % avg_urr_f =&
          (/&
          1.601400E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          2.200000E-07_8, &
          1.680000E-05_8, &
          1.680000E-05_8, &
          1.680000E-05_8, &
          1.680000E-05_8, &
          1.680000E-05_8, &
          1.680000E-05_8, &
          2.080000E-05_8, &
          2.080000E-05_8, &
          2.080000E-05_8, &
          2.080000E-05_8, &
          5.460000E-05_8, &
          5.460000E-05_8, &
          1.069720E-03_8, &
          5.460000E-05_8, &
          4.130000E-05_8, &
          4.130000E-05_8, &
          4.130000E-05_8, &
          1.840000E-05_8, &
          1.840000E-05_8, &
          1.840000E-05_8, &
          4.210000E-05_8, &
          4.210000E-05_8, &
          4.210000E-05_8, &
          2.180000E-05_8, &
          2.180000E-05_8, &
          2.180000E-05_8, &
          2.180000E-05_8, &
          2.385567E-05_8, &
          2.180000E-05_8, &
          2.180000E-05_8, &
          1.329164E-04_8, &
          2.180000E-05_8, &
          5.903646E-05_8  &
          /)

        tope % avg_urr_g =&
          (/&
          5.294767E-01_8, &
          5.191963E-01_8, &
          5.095385E-01_8, &
          4.999907E-01_8, &
          4.910007E-01_8, &
          4.807795E-01_8, &
          4.716119E-01_8, &
          4.626425E-01_8, &
          4.547108E-01_8, &
          4.458316E-01_8, &
          4.366955E-01_8, &
          4.287200E-01_8, &
          4.201544E-01_8, &
          4.120693E-01_8, &
          4.044001E-01_8, &
          3.963342E-01_8, &
          3.893020E-01_8, &
          3.824501E-01_8, &
          3.747055E-01_8, &
          3.682019E-01_8, &
          3.616666E-01_8, &
          3.552492E-01_8, &
          3.488653E-01_8, &
          3.118091E-01_8, &
          2.983457E-01_8, &
          2.851212E-01_8, &
          2.739781E-01_8, &
          2.626321E-01_8, &
          2.530123E-01_8, &
          2.432625E-01_8, &
          2.337822E-01_8, &
          2.253720E-01_8, &
          2.175639E-01_8, &
          2.103151E-01_8, &
          2.032248E-01_8, &
          1.969191E-01_8, &
          1.910510E-01_8, &
          1.855164E-01_8, &
          1.803572E-01_8, &
          1.752921E-01_8, &
          1.708923E-01_8, &
          1.670101E-01_8, &
          1.631601E-01_8, &
          1.592209E-01_8, &
          1.558020E-01_8, &
          1.529812E-01_8, &
          1.502219E-01_8, &
          1.473165E-01_8, &
          1.446661E-01_8, &
          1.424640E-01_8  &
          /)

        tope % avg_urr_x =&
          (/&
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          0.000000E+00_8, &
          7.715706E-02_8, &
          1.055265E-01_8, &
          1.384077E-01_8, &
          1.670278E-01_8, &
          1.983332E-01_8, &
          2.237622E-01_8, &
          2.521707E-01_8, &
          2.820737E-01_8, &
          3.121500E-01_8, &
          3.381797E-01_8, &
          3.656213E-01_8, &
          3.935862E-01_8, &
          4.176938E-01_8, &
          4.427483E-01_8, &
          4.692276E-01_8, &
          4.926203E-01_8, &
          5.159408E-01_8, &
          5.378257E-01_8, &
          5.588875E-01_8, &
          5.825779E-01_8, &
          6.046696E-01_8, &
          6.260870E-01_8, &
          6.457994E-01_8, &
          6.673022E-01_8, &
          6.865151E-01_8, &
          7.065286E-01_8, &
          7.257283E-01_8  &
          /)
      case default
        if (tope % LSSF == 1) then
          if (master) then
            write(*,'(A80)') 'Computing averaged URR cross sections&
              & for an LSSF = 1 isotope'
          end if
        end if
      end select
    end if

    tope % nEavg = size(tope % Eavg)

  end subroutine set_avg_urr_xs

end module avg_urr_xs_values
